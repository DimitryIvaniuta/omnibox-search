{
  "info": {
    "name": "search-platform \u2014 write-oltp GraphQL (auto-id chaining)",
    "_postman_id": "a3d8b2b2-8f5f-4e4c-9b8f-1760386955",
    "description": "GraphQL CRUD for Contact, Listing, Transaction \u2014 IDs & versions auto-saved to environment after create/update mutations.",
    "schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
  },
  "item": [
    {
      "name": "Contact",
      "item": [
        {
          "name": "Create Contact",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "X-Tenant",
                "value": "{{tenant}}"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/graphql",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "graphql"
              ]
            },
            "body": {
              "mode": "raw",
              "raw": "{\n  \"query\": \"mutation createContact($input: CreateContactInput!) { createContact(input: $input) { id fullName email phone label version } }\",\n  \"variables\": {\n    \"input\": {\n      \"fullName\": \"Sam Chen\",\n      \"email\": \"sam@example.com\",\n      \"phone\": \"+1234567\",\n      \"label\": \"Buyer\"\n    }\n  }\n}"
            }
          },
          "response": [],
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test(\"createContact ok\", function () {",
                  "  pm.expect(pm.response.code).to.be.oneOf([200]);",
                  "  const json = pm.response.json();",
                  "  pm.expect(json).to.have.property('data');",
                  "  const obj = json.data && json.data.createContact;",
                  "  pm.expect(obj).to.be.an('object');",
                  "  pm.environment.set('contactId', obj.id);",
                  "  pm.environment.set('contactVersion', obj.version);",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ]
        },
        {
          "name": "Get Contact by ID",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "X-Tenant",
                "value": "{{tenant}}"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/graphql",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "graphql"
              ]
            },
            "body": {
              "mode": "raw",
              "raw": "{\n  \"query\": \"query contact($id: ID!) { contact(id: $id) { id fullName email phone label version } }\",\n  \"variables\": {\n    \"id\": \"{{contactId}}\"\n  }\n}"
            }
          },
          "response": []
        },
        {
          "name": "Search Contacts (prefix)",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "X-Tenant",
                "value": "{{tenant}}"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/graphql",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "graphql"
              ]
            },
            "body": {
              "mode": "raw",
              "raw": "{\n  \"query\": \"query searchContacts($q: String!, $first: Int) { searchContacts(q: $q, first: $first) { id fullName email phone label version } }\",\n  \"variables\": {\n    \"q\": \"sam\",\n    \"first\": \"{{first}}\"\n  }\n}"
            }
          },
          "response": []
        },
        {
          "name": "Update Contact",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "X-Tenant",
                "value": "{{tenant}}"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/graphql",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "graphql"
              ]
            },
            "body": {
              "mode": "raw",
              "raw": "{\n  \"query\": \"mutation updateContact($id: ID!, $input: UpdateContactInput!) { updateContact(id: $id, input: $input) { id fullName email phone label version } }\",\n  \"variables\": {\n    \"id\": \"{{contactId}}\",\n    \"input\": {\n      \"fullName\": \"Samuel Chen\",\n      \"email\": \"sam@example.com\",\n      \"phone\": \"+1234567\",\n      \"label\": \"VIP\",\n      \"version\": \"{{contactVersion}}\"\n    }\n  }\n}"
            }
          },
          "response": [],
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test(\"updateContact ok\", function () {",
                  "  pm.expect(pm.response.code).to.be.oneOf([200]);",
                  "  const json = pm.response.json();",
                  "  const obj = json.data && json.data.updateContact;",
                  "  pm.expect(obj).to.be.an('object');",
                  "  pm.environment.set('contactVersion', obj.version);",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ]
        },
        {
          "name": "Delete Contact",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "X-Tenant",
                "value": "{{tenant}}"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/graphql",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "graphql"
              ]
            },
            "body": {
              "mode": "raw",
              "raw": "{\n  \"query\": \"mutation deleteContact($id: ID!, $version: Long!) { deleteContact(id: $id, version: $version) }\",\n  \"variables\": {\n    \"id\": \"{{contactId}}\",\n    \"version\": \"{{contactVersion}}\"\n  }\n}"
            }
          },
          "response": []
        }
      ]
    },
    {
      "name": "Listing",
      "item": [
        {
          "name": "Create Listing",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "X-Tenant",
                "value": "{{tenant}}"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/graphql",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "graphql"
              ]
            },
            "body": {
              "mode": "raw",
              "raw": "{\n  \"query\": \"mutation createListing($input: CreateListingInput!) { createListing(input: $input) { id title subtitle mlsId version contactId } }\",\n  \"variables\": {\n    \"input\": {\n      \"title\": \"Lakeview Home\",\n      \"subtitle\": \"3BR/2BA\",\n      \"contactId\": \"{{contactId}}\"\n    }\n  }\n}"
            }
          },
          "response": [],
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test(\"createListing ok\", function () {",
                  "  pm.expect(pm.response.code).to.be.oneOf([200]);",
                  "  const json = pm.response.json();",
                  "  const obj = json.data && json.data.createListing;",
                  "  pm.expect(obj).to.be.an('object');",
                  "  pm.environment.set('listingId', obj.id);",
                  "  pm.environment.set('listingVersion', obj.version);",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ]
        },
        {
          "name": "Get Listing by ID",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "X-Tenant",
                "value": "{{tenant}}"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/graphql",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "graphql"
              ]
            },
            "body": {
              "mode": "raw",
              "raw": "{\n  \"query\": \"query listing($id: ID!) { listing(id: $id) { id title subtitle mlsId version contactId } }\",\n  \"variables\": {\n    \"id\": \"{{listingId}}\"\n  }\n}"
            }
          },
          "response": []
        },
        {
          "name": "Search Listings (prefix)",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "X-Tenant",
                "value": "{{tenant}}"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/graphql",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "graphql"
              ]
            },
            "body": {
              "mode": "raw",
              "raw": "{\n  \"query\": \"query searchListings($q: String!, $first: Int) { searchListings(q: $q, first: $first) { id title subtitle mlsId version contactId } }\",\n  \"variables\": {\n    \"q\": \"home\",\n    \"first\": \"{{first}}\"\n  }\n}"
            }
          },
          "response": []
        },
        {
          "name": "Update Listing",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "X-Tenant",
                "value": "{{tenant}}"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/graphql",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "graphql"
              ]
            },
            "body": {
              "mode": "raw",
              "raw": "{\n  \"query\": \"mutation updateListing($id: ID!, $input: UpdateListingInput!) { updateListing(id: $id, input: $input) { id title subtitle mlsId version contactId } }\",\n  \"variables\": {\n    \"id\": \"{{listingId}}\",\n    \"input\": {\n      \"title\": \"Lakeview House\",\n      \"subtitle\": \"3BR/2BA updated\",\n      \"contactId\": \"{{contactId}}\",\n      \"version\": \"{{listingVersion}}\"\n    }\n  }\n}"
            }
          },
          "response": [],
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test(\"updateListing ok\", function () {",
                  "  pm.expect(pm.response.code).to.be.oneOf([200]);",
                  "  const json = pm.response.json();",
                  "  const obj = json.data && json.data.updateListing;",
                  "  pm.expect(obj).to.be.an('object');",
                  "  pm.environment.set('listingVersion', obj.version);",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ]
        },
        {
          "name": "Delete Listing",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "X-Tenant",
                "value": "{{tenant}}"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/graphql",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "graphql"
              ]
            },
            "body": {
              "mode": "raw",
              "raw": "{\n  \"query\": \"mutation deleteListing($id: ID!, $version: Long!) { deleteListing(id: $id, version: $version) }\",\n  \"variables\": {\n    \"id\": \"{{listingId}}\",\n    \"version\": \"{{listingVersion}}\"\n  }\n}"
            }
          },
          "response": []
        }
      ]
    },
    {
      "name": "Transaction",
      "item": [
        {
          "name": "Create Transaction",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "X-Tenant",
                "value": "{{tenant}}"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/graphql",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "graphql"
              ]
            },
            "body": {
              "mode": "raw",
              "raw": "{\n  \"query\": \"mutation createTransaction($input: CreateTransactionInput!) { createTransaction(input: $input) { id title subtitle amount currency status version contactId listingId } }\",\n  \"variables\": {\n    \"input\": {\n      \"title\": \"Offer Accepted\",\n      \"subtitle\": \"Escrow opened\",\n      \"amount\": 450000.0,\n      \"currency\": \"USD\",\n      \"status\": \"OPEN\",\n      \"contactId\": \"{{contactId}}\",\n      \"listingId\": \"{{listingId}}\"\n    }\n  }\n}"
            }
          },
          "response": [],
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test(\"createTransaction ok\", function () {",
                  "  pm.expect(pm.response.code).to.be.oneOf([200]);",
                  "  const json = pm.response.json();",
                  "  const obj = json.data && json.data.createTransaction;",
                  "  pm.expect(obj).to.be.an('object');",
                  "  pm.environment.set('transactionId', obj.id);",
                  "  pm.environment.set('transactionVersion', obj.version);",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ]
        },
        {
          "name": "Get Transaction by ID",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "X-Tenant",
                "value": "{{tenant}}"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/graphql",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "graphql"
              ]
            },
            "body": {
              "mode": "raw",
              "raw": "{\n  \"query\": \"query transaction($id: ID!) { transaction(id: $id) { id title subtitle amount currency status version contactId listingId } }\",\n  \"variables\": {\n    \"id\": \"{{transactionId}}\"\n  }\n}"
            }
          },
          "response": []
        },
        {
          "name": "Search Transactions (prefix)",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "X-Tenant",
                "value": "{{tenant}}"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/graphql",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "graphql"
              ]
            },
            "body": {
              "mode": "raw",
              "raw": "{\n  \"query\": \"query searchTransactions($q: String!, $first: Int) { searchTransactions(q: $q, first: $first) { id title subtitle amount currency status version contactId listingId } }\",\n  \"variables\": {\n    \"q\": \"sale\",\n    \"first\": \"{{first}}\"\n  }\n}"
            }
          },
          "response": []
        },
        {
          "name": "Update Transaction",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "X-Tenant",
                "value": "{{tenant}}"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/graphql",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "graphql"
              ]
            },
            "body": {
              "mode": "raw",
              "raw": "{\n  \"query\": \"mutation updateTransaction($id: ID!, $input: UpdateTransactionInput!) { updateTransaction(id: $id, input: $input) { id title subtitle amount currency status version contactId listingId } }\",\n  \"variables\": {\n    \"id\": \"{{transactionId}}\",\n    \"input\": {\n      \"title\": \"Closed\",\n      \"subtitle\": \"Recorded\",\n      \"amount\": 455000.0,\n      \"currency\": \"USD\",\n      \"status\": \"CLOSED\",\n      \"contactId\": \"{{contactId}}\",\n      \"listingId\": \"{{listingId}}\",\n      \"version\": \"{{transactionVersion}}\"\n    }\n  }\n}"
            }
          },
          "response": [],
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test(\"updateTransaction ok\", function () {",
                  "  pm.expect(pm.response.code).to.be.oneOf([200]);",
                  "  const json = pm.response.json();",
                  "  const obj = json.data && json.data.updateTransaction;",
                  "  pm.expect(obj).to.be.an('object');",
                  "  pm.environment.set('transactionVersion', obj.version);",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ]
        },
        {
          "name": "Delete Transaction",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "X-Tenant",
                "value": "{{tenant}}"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/graphql",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "graphql"
              ]
            },
            "body": {
              "mode": "raw",
              "raw": "{\n  \"query\": \"mutation deleteTransaction($id: ID!, $version: Long!) { deleteTransaction(id: $id, version: $version) }\",\n  \"variables\": {\n    \"id\": \"{{transactionId}}\",\n    \"version\": \"{{transactionVersion}}\"\n  }\n}"
            }
          },
          "response": []
        }
      ]
    }
  ],
  "variable": [
    {
      "key": "baseUrl",
      "value": "http://localhost:8081"
    },
    {
      "key": "tenant",
      "value": "demo-tenant"
    },
    {
      "key": "first",
      "value": "20"
    },
    {
      "key": "contactId",
      "value": ""
    },
    {
      "key": "contactVersion",
      "value": ""
    },
    {
      "key": "listingId",
      "value": ""
    },
    {
      "key": "listingVersion",
      "value": ""
    },
    {
      "key": "transactionId",
      "value": ""
    },
    {
      "key": "transactionVersion",
      "value": ""
    }
  ]
}